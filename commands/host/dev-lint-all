#!/bin/bash

## #ddev-generated
## Description: Run all linting tools on custom modules and themes files
## Fail on errors
set -euo pipefail

# Default files pattern if no arguments provided
if [ $# -eq 0 ]; then
  # Find all custom PHP, JS, CSS, and Twig files
  FILES=$(find docroot/modules/custom docroot/themes/custom \
    -type f \( \
    -name "*.php" -o \
    -name "*.module" -o \
    -name "*.css" -o \
    -name "*.js" -o \
    -name "*.twig" \
    \) -print0 | xargs -0)
  set -- "--files" "$FILES"
fi

echo "Running all linting tools..."

echo -e "\nğŸ” Running PHP CodeSniffer..."
ddev dev-phpcs "$@" || exit $?

echo -e "\nğŸ” Running ESLint..."
ddev dev-eslint "$@" || exit $?

echo -e "\nğŸ” Running Stylelint..."
ddev dev-stylelint "$@" || exit $?

echo -e "\nğŸ” Running TwigCS Fixer..."
ddev dev-twigcs "$@" || exit $?

echo -e "\nğŸ” Running PHPStan..."
ddev dev-phpstan "$@" || exit $?