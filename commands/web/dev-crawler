#!/bin/bash

## #ddev-generated
## Description: Run Drupal Java Crawler
## Usage: dev-crawler
## Example: "ddev dev-crawler"

# Check if Maven project exists, if not initialize it
if [ ! -f "/var/www/html/.ddev/drupal_java_crawler/pom.xml" ]; then
    echo "‚ùå Error: Java crawler files not found!"
    echo "Please ensure the ddev-dev-tools addon is properly installed."
    exit 1
fi

# Navigate to the crawler directory
cd /var/www/html/.ddev/drupal_java_crawler

# Check if compiled, if not compile first
if [ ! -d "target/classes" ]; then
    echo "üì¶ Compiling Java Crawler for first use..."
    mvn clean compile -q
    if [ $? -ne 0 ]; then
        echo "‚ùå Compilation failed. Please check the error messages above."
        exit 1
    fi
    echo "‚úì Compilation successful!"
    echo ""
fi

# Run Maven exec:java
echo "Starting Drupal Java Crawler..."
mvn exec:java
